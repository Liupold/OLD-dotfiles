#!/bin/sh

selected_song="$(find Music/ -type f | dmenu -l 10 -b | xargs basename)"
if [ -n "${selected_song}" ];
then
        pidof cmus || screen -dmS 'cmus' /usr/bin/cmus

        while true; do cmus-remote -Q > /dev/null 2>&1 && break; sleep 1 ; done ;

        screen -S 'cmus' -p 0 -X stuff ":clear^M:add ${LUNA_MUSIC_DIR}^M"
        screen -S 'cmus' -p 0 -X stuff "/${selected_song}^M^M"
fi
